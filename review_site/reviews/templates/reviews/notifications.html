{% extends 'reviews/base.html' %}

{% block content %}
    <div style="max-width: 600px; margin: 0 auto; padding: 20px;">
        <h1>通知</h1>
        
        {% if confirmation_message %}
            <div style="margin-bottom: 15px; padding: 10px; background-color: #d4edda; border: 1px solid #c3e6cb; border-radius: 5px; color: #155724; text-align: center;">
                <small>📋 {{ confirmation_message }} これらの通知は削除されました。</small>
            </div>
        {% endif %}
        
        <div style="background: white; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
            {% for notification in notifications %}
                <div style="padding: 15px; border-bottom: 1px solid #eee; {% if not notification.is_read %}background-color: #f8f9fa;{% endif %}">
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <!-- 送信者のアイコン -->
                        {% if notification.from_user.profile and notification.from_user.profile.get_avatar_url %}
                            <img src="{{ notification.from_user.profile.get_avatar_url }}" alt="{{ notification.from_user.username }}のアイコン" 
                                 style="width: 40px; height: 40px; border-radius: 50%; object-fit: cover;">
                        {% else %}
                            <div style="width: 40px; height: 40px; border-radius: 50%; background-color: #ddd; display: flex; align-items: center; justify-content: center; font-size: 16px; color: #666; font-weight: bold;">
                                {{ notification.from_user.username|first|upper }}
                            </div>
                        {% endif %}
                        
                        <div style="flex: 1;">
                            <p style="margin: 0; color: #333;">{{ notification.message }}</p>
                            <small style="color: #888;">{{ notification.created_at|date:"Y/m/d H:i" }}</small>
                        </div>
                        
                        {% if notification.notification_type == 'follow' %}
                            <a href="{% url 'user_profile' notification.from_user.id %}" style="background-color: #007bff; color: white; padding: 5px 10px; text-decoration: none; border-radius: 3px; font-size: 12px;">
                                プロフィールを見る
                            </a>
                        {% endif %}
                    </div>
                </div>
            {% empty %}
                <div style="padding: 40px; text-align: center; color: #666;">
                    <p>通知はありません。</p>
                    <small style="color: #999; display: block; margin-top: 10px;">
                        ※ 通知は一度確認すると自動的に削除されます
                    </small>
                </div>
            {% endfor %}
        </div>
    </div>
{% endblock %}
